<div class="card" id="card-vid">
    <div class="card-header"><strong>VID</strong> <small>without Verification</small></div>
    <div class="card-body">
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="select-function">Function</label>
                    <div class="col-sm-8">
                        <select class="form-control form-control-sm" id="select-function" size="1">
                            <option value="verifyVID">verifyVID</option>
                            <option value="getVIDRandomValue" selected>getVIDRandomValue</option>
                            <option value="getPrikeyEx">getPrikeyEx</option>
                            <option value="getPrikeyWithNewPassword">getPrikeyWithNewPassword</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <hr>

        <!-- row -->
        <div class="row">
            <div class="col-sm-6 d-none" id="idn-wrapper">
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="text-idn">ID Number</label>
                    <div class="col-sm-8">
                        <input class="form-control form-control-sm" type="text" id="text-idn" name="text-idn"
                            value="1234561234563">
                    </div>
                </div>
            </div>
        </div>
        <!-- /.row -->

        <div class="row d-none" id="rsa-algorithm-wrapper">
            <div class="col-sm-6">
                <div class="form-group row" id="envelop-cert">
                    <label class="col-md-4" for="textarea-server-cert">RSA Public Key <small>(한정인(개인)
                            signCert.der)</small></label>
                    <div class="col-md-8">
                        <textarea class="form-control form-control-sm" id="textarea-server-cert"
                            name="textarea-server-cert"
                            rows="2">MIIFyzCCBLOgAwIBAgIEBOAzejANBgkqhkiG9w0BAQsFADBKMQswCQYDVQQGEwJLUjENMAsGA1UECgwES0lDQTEVMBMGA1UECwwMQWNjcmVkaXRlZENBMRUwEwYDVQQDDAxzaWduR0FURSBDQTUwHhcNMTkwNzA4MDY0NTAwWhcNMjAwNzA4MTQ1OTU5WjCBkjELMAkGA1UEBhMCS1IxDTALBgNVBAoMBEtJQ0ExEzARBgNVBAsMCmxpY2Vuc2VkQ0ExFTATBgNVBAsMDOuTseuhneq4sOq0gDEZMBcGA1UECwwQS0lDQeqzoOqwneyEvO2EsDERMA8GA1UECwwI7IS87YSwUkExGjAYBgNVBAMMEe2VnOygleyduCjqsJzsnbgpMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAiszgCtp4M43q6Ptq4cYoB/jqsY3EXt/LPQGcQzOT4/9nDnLtFoShADNx8i2nUZGCy4dOSexuhDeX0NwTffMK3kNQBc9SkQ5ye/ro8Gzc+v2eI+sGFH4oo/KgG+PIUjG9H5GYsY6de+TEg9+zMmhkeHDAh8I8jc0QTW9btBKxWOgSAF5JBsuL1fPdIUKskoSYH4OY8gu/6yTNMG16qoMJxzW+y2bKvx5jq1Qqf+cHGx1M5vw147BGuHJhLapgI+LoWX04hI6ysPFiyzO9IXuxonpKX3m7oKJMF5Ht2hXEvAl9O6WiUqZDfxpCPPpb8Egnp63CvZOQ/d+8wq4Jy2WZ5QIDAQABo4ICbjCCAmowgY8GA1UdIwSBhzCBhIAU2L467EWZxZ7jnOqBH9IdErA2PoihaKRmMGQxCzAJBgNVBAYTAktSMQ0wCwYDVQQKDARLSVNBMS4wLAYDVQQLDCVLb3JlYSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSBDZW50cmFsMRYwFAYDVQQDDA1LSVNBIFJvb3RDQSA0ggIQHTAdBgNVHQ4EFgQUOJKmGzgbahSwjUQWtdVn8Lcmu00wDgYDVR0PAQH/BAQDAgbAMHUGA1UdIARuMGwwagYKKoMajJpEBQIBAjBcMCwGCCsGAQUFBwIBFiBodHRwOi8vd3d3LnNpZ25nYXRlLmNvbS9jcHMuaHRtbDAsBggrBgEFBQcCAjAgHh7HdAAgx3jJncEcspQAIKz1x3jHeMmdwRzHhbLIsuQwgYgGA1UdEQSBgDB+gRVwdXJlMjcxM0BzaWduZ2F0ZS5jb22gZQYJKoMajJpECgEBoFgwVgwR7ZWc7KCV7J24KOqwnOyduCkwQTA/BgoqgxqMmkQKAQEBMDEwCwYJYIZIAWUDBAIBoCIEIIgrBYVsaT0ERzn12ajpzrTCdgQ4kN4sPHmvpTmUDd89MF8GA1UdHwRYMFYwVKBSoFCGTmxkYXA6Ly9sZGFwLnNpZ25nYXRlLmNvbTozODkvb3U9ZHA3cDE0ODAzLG91PWNybGRwLG91PUFjY3JlZGl0ZWRDQSxvPUtJQ0EsYz1LUjBEBggrBgEFBQcBAQQ4MDYwNAYIKwYBBQUHMAGGKGh0dHA6Ly9vY3NwLnNpZ25nYXRlLmNvbTo5MDIwL09DU1BTZXJ2ZXIwDQYJKoZIhvcNAQELBQADggEBAKKJVYn61+9l/+cAbY12mmLTBRPkBjtIGuCEESIncjgRFBSYCj/fDiACNoj9NpOeuzxqsXZvEXnt8mXsNT5Eg5ZnwWCDLNn4DFfmL0ShETRTeZiIG2taAhAZVxhSAlvRp+fJISnGQgvXqZht2aptoLAxsAcVkp52kHTNN/VAZKwsrbycIMUarG6GIXilzmo7PZ4ljw0cujQteHAk41UflKCh9SrKU5hCqK/d1ndk3fujih4AC3pwYyulWPy3r+UumVXeMxHerj7wgS83XkzxDtlNbE+Z4A1+MiqYC9SPXv6T1EscaCMd+DY/SlF+6CD//2V8YixISzBRy6KB3anGSAg=</textarea>
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="select-rsa-algorithm">RSA Algorithm</label>
                    <div class="col-sm-8">
                        <select class="form-control form-control-sm overflow-hidden" id="select-rsa-algorithm" size="2">
                            <option value="V15" selected>V15</option>
                            <option value="V21">V21</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="row d-none" id="pkcs-version-wrapper">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="select-pkcs-version">PKCS Version</label>
                    <div class="col-sm-8">
                        <select class="form-control form-control-sm" id="select-pkcs-version" size="1">
                            <option value="PKCS8" selected>PKCS8</option>
                            <option value="PKCS1">PKCS1</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="select-cert-type">Certificate Type</label>
                    <div class="col-sm-8">
                        <select class="form-control form-control-sm" id="select-cert-type" name="select-cert-type"
                            size="1">
                            <option selected value="SignCert">SignCert</option>
                            <option value="EncryptCert">EncryptCert</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6 d-none" id="password-wrapper">
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="text-password">Password</label>
                    <div class="col-sm-8">
                        <input class="form-control form-control-sm" type="text" id="text-password" value="signgate1!">
                    </div>
                </div>
            </div>
        </div>
        <button class="btn btn-sm btn-pill btn-block btn-dark" id="button-run" type="button">Run</button>

        
        <textarea class="form-control form-control-sm" id="textarea-vid-result" name="textarea-vid-result"
            rows="6"></textarea>
    </div>
</div>

<script>
    var func;
    $('#select-function').change(function () {
        func = $(this).val();
        $("#rsa-algorithm-wrapper, #pkcs-version-wrapper, #idn-wrapper, #password-wrapper").addClass('d-none');
        if (func.indexOf("verifyVID") >= 0)
            $("#idn-wrapper").removeClass('d-none');
        else if (func.indexOf("PrikeyEx") >= 0)
            $("#rsa-algorithm-wrapper, #pkcs-version-wrapper").removeClass('d-none');
        else if (func.indexOf("NewPassword") >= 0)
            $("#password-wrapper").removeClass('d-none');
    })

    $('#button-run').click(function () {
        func = $('#select-function').val();
        processLogic.init();
        processLogic.setProcessLogic(func);

        NX_ShowDialog();
    });


    function SecuKitNXS_RESULT(cmd, res) {
        if (res.ERROR_CODE !== undefined) {
            // Error Message 출력
            $('.nx-cert-select').hide(); $('#nx-pki-ui-wrapper').hide(); KICA_Error.init();
            KICA_Error.setError(res.ERROR_CODE, res.ERROR_MESSAGE);
            var errorMsg = KICA_Error.getError();
            alert(errorMsg);
            return;
        }

        switch (cmd) {
            case 'verifyVID':
                var cmd = "result." + func;
                var ssn = $('#text-idn').val();
                var param = JSON.stringify({
                    'certID': res,
                    'ssn': ssn
                });
                secukitnxInterface.SecuKitNXS(cmd, param);
                break;

            case 'getVIDRandomValue':
                var cmd = "result." + func;
                var param = JSON.stringify({
                    'certID': res
                });
                secukitnxInterface.SecuKitNXS(cmd, param);
                break;


            case 'getPrikeyEx':
                var cmd = "result." + func;
                var ssn = $('#text-idn').val();
                var param = JSON.stringify({
                    'certType': $("#select-cert-type").val(),
                    'pkcsSpec': $("#select-pkcs-version").val(),
                    'kmServerCert': $("#textarea-server-cert").val(),
                    'rsaVersion': $("#select-rsa-algorithm").val(),
                    'certID': res,
                    'messageType': 'p7e'
                });
                secukitnxInterface.SecuKitNXS(cmd, param);
                break;

            case 'getPrikeyWithNewPassword':
                var cmd = "result." + func;
                var param = JSON.stringify({
                    'certType': $("#select-cert-type").val(),
                    'messageType': 'p7e',
                    'certID': res,
                    'password': $("#text-password").val()

                });
                secukitnxInterface.SecuKitNXS(cmd, param);
                break;

            case 'result':
                var result = eval("res." + func);
                $('#textarea-vid-result').val(result);
                break;

            default: break;
        }

    }
</script>